<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Flask+Celery</title>
    <url>/2023/05/27/Flask+Celery/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨ç”¨è‡ªå·±ä¹‹å‰å†™çš„é‚£ä¸ªpdscançš„æ—¶å€™ï¼Œæ„Ÿè§‰åˆ°ç•¥æœ‰ä¸é€‚ï¼Œæ—¶ä¸æ—¶ä¼šå‡ºç°æ¯”è¾ƒè¯¡å¼‚çš„bugï¼ŒåŒæ—¶ä¹Ÿç¼ºå°‘ä¸€å †è‡ªå·±æƒ³è¦çš„åŠŸèƒ½ï¼Œäºæ˜¯è€ƒè™‘èŠ±å‡ å¤©ä¿®ä¸€ä¿®bugï¼ŒåŠ ä¸€ç‚¹åŠŸèƒ½</p>
<p>å½“æ—¶å†™pdscançš„æ—¶å€™æ²¡å­¦è¿‡ä»€ä¹ˆå«æ¶ˆæ¯ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿæ‡’å¾—æï¼Œæ‰€ä»¥å°±è‡ªå·±ç”¨<code>@app.before_first_request</code>å’Œå¤šçº¿ç¨‹å¼„äº†ä¸ªåå°ä»»åŠ¡ï¼Œç°åœ¨æ¥çœ‹æœ‰ç‚¹ç®€é™‹äº†</p>
<p>æ‰“ç®—è¿™æ¬¡åŠ åŠŸèƒ½çš„æ—¶å€™ï¼Œé¡ºé“æŠŠè‡ªå·±å†™çš„è¿™ä¸œè¥¿æ¢æ‰ï¼Œåˆ«æ”¾åœ¨githubä¸Šä¸¢äººäº†</p>
<h2 id="ä»€ä¹ˆæ˜¯celery"><a href="#ä»€ä¹ˆæ˜¯celery" class="headerlink" title="ä»€ä¹ˆæ˜¯celery"></a>ä»€ä¹ˆæ˜¯celery</h2><p>Celeryæ˜¯ä¸€ä¸ªåŸºäºpythonå¼€å‘çš„åˆ†å¸ƒå¼å¼‚æ­¥æ¶ˆæ¯ä»»åŠ¡é˜Ÿåˆ—ï¼Œé€šè¿‡å®ƒå¯ä»¥è½»æ¾çš„å®ç°ä»»åŠ¡çš„å¼‚æ­¥å¤„ç†</p>
<p>Celeryçš„æ¶æ„ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆmessage brokerï¼‰ï¼Œä»»åŠ¡æ‰§è¡Œå•å…ƒï¼ˆworkerï¼‰å’Œä»»åŠ¡æ‰§è¡Œç»“æœå­˜å‚¨ï¼ˆtask result storeï¼‰</p>
<p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯å½“ç¨‹åºäº§ç”Ÿå¼‚æ­¥ä»»åŠ¡éœ€æ±‚æ—¶ï¼Œé€šè¿‡Celeryå°†å¼‚æ­¥ä»»åŠ¡å‘é€è‡³brokeræš‚å­˜ï¼ŒåŒæ—¶workerä»brokerä¸­é¢†å–å±äºè‡ªå·±çš„ä»»åŠ¡å¹¶è¿›è¡Œå¤„ç†å’Œç»“æœå­˜å‚¨ï¼Œä»è€Œé¿å…æ—¶é—´è¿‡é•¿çš„å¼‚æ­¥ä»»åŠ¡å¯¹ä¸»ä»»åŠ¡äº§ç”Ÿå½±å“</p>
<p>ç”¨äºæš‚å­˜ä»»åŠ¡é˜Ÿåˆ—çš„brokerå¯ä»¥ä½¿RabbitMQï¼Œä¹Ÿå¯ä»¥æ˜¯redis</p>
<p><img src="http://pic.rayi.sdpcsec.cn/SouthEast.png" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<h3 id="å®‰è£…å’Œç¤ºä¾‹"><a href="#å®‰è£…å’Œç¤ºä¾‹" class="headerlink" title="å®‰è£…å’Œç¤ºä¾‹"></a>å®‰è£…å’Œç¤ºä¾‹</h3><p>Rediså®‰è£…ç•¥</p>
<p>å®‰è£…Celeryå’ŒRedisï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install celery redis</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨redis</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-server</span><br></pre></td></tr></table></figure>



<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># test.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> Celery</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º Celery å®ä¾‹</span></span><br><span class="line">app = Celery(<span class="string">&#x27;testTask&#x27;</span>, broker=<span class="string">&#x27;redis://localhost:6379/0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_task1</span>():</span><br><span class="line">    <span class="comment"># ç”Ÿæˆä»»åŠ¡md5</span></span><br><span class="line">    task_id = md5(<span class="built_in">str</span>(time.time()).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºtask_idä¸ºåç§°çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡1:<span class="subst">&#123;task_id&#125;</span> æ‰§è¡Œäº:&#x27;</span>, datetime.now())</span><br><span class="line">    time.sleep(<span class="number">7</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡1:<span class="subst">&#123;task_id&#125;</span> ç»“æŸäº:&#x27;</span>, datetime.now())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_task2</span>():</span><br><span class="line">    <span class="comment"># ç”Ÿæˆä»»åŠ¡md5</span></span><br><span class="line">    task_id = md5(<span class="built_in">str</span>(time.time()).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœ¨æ­¤å¤„å®šä¹‰ä½ çš„ä»»åŠ¡é€»è¾‘</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡2:<span class="subst">&#123;task_id&#125;</span> æ‰§è¡Œäº:&#x27;</span>, datetime.now())</span><br><span class="line">    time.sleep(<span class="number">9</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡2:<span class="subst">&#123;task_id&#125;</span> ç»“æŸäº:&#x27;</span>, datetime.now())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨Celery worker</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m celery -A test worker --loglevel=info</span><br></pre></td></tr></table></figure>

<p>è¿™å°†å¯åŠ¨Celery workerï¼Œä½¿å…¶å‡†å¤‡å¥½æ¥æ”¶å’Œæ‰§è¡Œä»»åŠ¡ã€‚</p>
<p><img src="http://pic.rayi.sdpcsec.cn/image-20230522195950762.png" alt="image-20230522195950762"></p>
<p>å‘brokeræ·»åŠ ä»»åŠ¡ï¼Œå¯ä»¥çœ‹åˆ°ç›´æ¥å°±è¿”å›äº†ç»“æœï¼Œæ²¡æœ‰ç­‰å¾…sleepå’Œè¾“å‡º</p>
<p><img src="http://pic.rayi.sdpcsec.cn/image-20230522200726716.png" alt="image-20230522200726716"></p>
<p>åœ¨çœ‹celeryçš„é¡µé¢</p>
<p><img src="http://pic.rayi.sdpcsec.cn/image-20230522200822739.png" alt="image-20230522200822739"></p>
<h3 id="çŠ¶æ€"><a href="#çŠ¶æ€" class="headerlink" title="çŠ¶æ€"></a>çŠ¶æ€</h3><p>Celery å¯ä»¥è·Ÿè¸ªä»»åŠ¡å½“å‰çš„çŠ¶æ€ä¿¡æ¯ã€‚çŠ¶æ€ä¿¡æ¯åŒ…å«æˆåŠŸä»»åŠ¡çš„ç»“æœï¼Œæˆ–æ‰§è¡Œå¤±è´¥ä»»åŠ¡çš„å¼‚å¸¸ä¿¡æ¯ã€‚</p>
<p>åœ¨ä»»åŠ¡çš„æ‰§è¡Œå‘¨æœŸä¸­ï¼Œå¯èƒ½ä¼šæœ‰å‡ ç§çŠ¶æ€çš„å˜æ¢ï¼Œæ¯æ¬¡å˜æ¢éƒ½ä¼šé™„åŠ å½“å‰çŠ¶æ€ä¿¡æ¯ã€‚å½“ä»»åŠ¡è¿›å…¥ä¸‹ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œä¸Šä¸€ä¸ªçŠ¶æ€çš„ä¿¡æ¯ä¼šè¢«ç§»é™¤ï¼Œä½†å¯ä»¥è¿›è¡Œæ¨æ–­ä»»åŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªä»»åŠ¡å¤„äºæ‰§è¡Œ <code>FAILED</code> çŠ¶æ€ï¼Œåˆ™è¡¨ç¤ºåœ¨æŸä¸ªæ—¶åˆ»æ˜¯å¤„äº <code>STARTED</code> çŠ¶æ€çš„ï¼‰ã€‚</p>
<p>å¦‚æœéœ€è¦è·Ÿè¸ªä»»åŠ¡ä¿¡æ¯ã€çŠ¶æ€æˆ–è¿”å›å€¼ï¼Œéœ€è¦æä¾›ä¸€ä¸ª Celery å­˜å‚¨çš„ç»“æœåç«¯ï¼Œä¾¿äºæ£€ç´¢ã€‚æœ‰å‡ ä¸ªå†…ç½®çš„ç»“æœåç«¯å¯ä»¥è€ƒè™‘ä½¿ç”¨ï¼šSQLAlchemy&#x2F;Django ORMã€Memcachedã€RabbitMQ&#x2F;QPid(rpc) å’Œ Redisï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰åç«¯ã€‚</p>
<h4 id="å†…ç½®çŠ¶æ€"><a href="#å†…ç½®çŠ¶æ€" class="headerlink" title="å†…ç½®çŠ¶æ€"></a>å†…ç½®çŠ¶æ€</h4><ul>
<li><p>PENDING</p>
<ul>
<li>ä»»åŠ¡æ­£åœ¨ç­‰å¾…æ‰§è¡Œæˆ–æœªçŸ¥ã€‚ä»»ä½•æœªçŸ¥çš„ä»»åŠ¡ ID éƒ½é»˜è®¤å¤„äºæŒ‚èµ·çŠ¶æ€ã€‚</li>
</ul>
</li>
<li><p>STARTED</p>
<ul>
<li>ä»»åŠ¡å·²ç»å¼€å§‹ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šè®°å½•ï¼Œéœ€è¦å¯ç”¨ï¼Œè¯·å‚é˜… <code>app.Task.track_started.</code>ã€‚</li>
<li>meta-dataï¼šæ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„èŒç¨‹ï¼ˆWorkerï¼‰ pid å’Œä¸»æœºåã€‚</li>
</ul>
</li>
<li><p>SUCCESS</p>
<ul>
<li>ä»»åŠ¡æ‰§è¡ŒæˆåŠŸã€‚</li>
<li>meta-dataï¼šä»»åŠ¡ç»“æœè¿”å›å€¼ propagatesï¼šYes ready: Yes</li>
</ul>
</li>
<li><p>FAILURE</p>
<ul>
<li>ä»»åŠ¡æ‰§è¡Œå¤±è´¥ã€‚</li>
<li>meta-dataï¼šæ‰§è¡Œå¼‚å¸¸æ—¶çš„ä»»åŠ¡ä¿¡æ¯ï¼Œå…¶ä¸­ traceback åŒ…å«å¼•å‘é”™è¯¯çš„å †æ ˆä¿¡æ¯ã€‚ propagatesï¼šYes</li>
</ul>
</li>
<li><p>RETRY</p>
<ul>
<li>ä»»åŠ¡å¤„äºé‡è¯•çŠ¶æ€ã€‚</li>
<li>meta-dataï¼šç»“æœä¿¡æ¯åŒ…å«å¯¼è‡´é‡è¯•çš„å¼‚å¸¸ä¿¡æ¯ï¼Œtraceback åŒ…å«å¼•å‘å¼‚å¸¸æ—¶å †æ ˆçš„å›æº¯ã€‚ propagatesï¼šNo</li>
</ul>
</li>
<li><p>REVOKED</p>
<ul>
<li>ä»»åŠ¡è¢«æ’¤é”€ã€‚</li>
<li>propagatesï¼šYes</li>
</ul>
</li>
</ul>
<h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>è¿˜æ˜¯ç”¨ä¸Šé¢çš„é‚£ä¸ªæºç ï¼Œä½†æ˜¯åœ¨åˆ›å»ºceleryå®ä¾‹æ—¶ï¼Œè¦å¼€å¯å­˜å‚¨ç»“æœåç«¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º Celery å®ä¾‹</span></span><br><span class="line">app = Celery(<span class="string">&#x27;tasks&#x27;</span>, broker=<span class="string">&#x27;redis://localhost:6379/0&#x27;</span>, backend=<span class="string">&#x27;redis://localhost:6379/1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨delay()æ–¹æ³•ä¼šè¿”å›ä»»åŠ¡å¯¹è±¡ï¼Œè°ƒç”¨ä»»åŠ¡å¯¹è±¡çš„<code>.state</code>å±æ€§å³å¯çœ‹åˆ°å½“å‰ä»»åŠ¡çš„ä»»åŠ¡çŠ¶æ€</p>
<p><img src="http://pic.rayi.sdpcsec.cn/image-20230522202227723.png" alt="image-20230522202227723"></p>
<h3 id="çŠ¶æ€æ§åˆ¶"><a href="#çŠ¶æ€æ§åˆ¶" class="headerlink" title="çŠ¶æ€æ§åˆ¶"></a>çŠ¶æ€æ§åˆ¶</h3><p>ç»ˆæ­¢æœªå¼€å§‹çš„ç‰¹å®šä»»åŠ¡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> celery.result <span class="keyword">import</span> AsyncResult</span><br><span class="line">AsyncResult(c.task_id).revoke()</span><br></pre></td></tr></table></figure>

<p>ç»ˆæ­¢å·²ç»å¼€å§‹çš„ä»»åŠ¡ï¼Œä½†ä¸ä¼šç»“æŸå…¶å¯åŠ¨çš„è¿›ç¨‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> celery.result <span class="keyword">import</span> AsyncResult</span><br><span class="line">AsyncResult(c.task_id).revoke(terminate=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_task1</span>():</span><br><span class="line">    <span class="comment"># ç”Ÿæˆä»»åŠ¡md5</span></span><br><span class="line">    task_id = md5(<span class="built_in">str</span>(time.time()).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºtask_idä¸ºåç§°çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡1:<span class="subst">&#123;task_id&#125;</span>æ‰§è¡Œäº:&#x27;</span>, datetime.now())</span><br><span class="line">    os.system(<span class="string">&quot;sleep 10&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡1:<span class="subst">&#123;task_id&#125;</span>ç»“æŸäº:&#x27;</span>, datetime.now())</span><br></pre></td></tr></table></figure>

<p>ç»ˆæ­¢æŒ‡ä»¤ä¸‹è¾¾åï¼Œè¿˜æ˜¯èƒ½çœ‹åˆ°sleepçš„è¿›ç¨‹</p>
<h3 id="å®šæ—¶ä»»åŠ¡"><a href="#å®šæ—¶ä»»åŠ¡" class="headerlink" title="å®šæ—¶ä»»åŠ¡"></a>å®šæ—¶ä»»åŠ¡</h3><p><code>celery beat</code> æ˜¯ä¸€ä¸ªè°ƒåº¦ç¨‹åºï¼›å®ƒå®šæœŸå¯åŠ¨ä»»åŠ¡ï¼Œç„¶åç”±é›†ç¾¤ä¸­çš„å¯ç”¨èŠ‚ç‚¹æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ä¼šä»é…ç½®ä¸­çš„ <code>beat_schedule</code> é¡¹ä¸­è·å–æ¡ç›®(entries)ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å­˜å‚¨ï¼Œä¾‹å¦‚å°†<strong>entries</strong>å­˜å‚¨åœ¨SQLæ•°æ®åº“ä¸­ã€‚</p>
<p>åº”ç¡®ä¿ä¸€æ¬¡åªè¿è¡Œä¸€ä¸ªè°ƒåº¦ç¨‹åºæ¥æ‰§è¡Œä¸€ä¸ªè°ƒåº¦ç¨‹åºï¼Œå¦åˆ™æœ€ç»ˆå°†å¯¼è‡´é‡å¤çš„ä»»åŠ¡ã€‚ä½¿ç”¨é›†ä¸­å¼æ–¹æ³•æ„å‘³ç€æ—¶é—´è¡¨ä¸å¿…åŒæ­¥ï¼Œå¹¶ä¸”è¯¥æœåŠ¡å¯ä»¥åœ¨ä¸ä½¿ç”¨é”çš„æƒ…å†µä¸‹è¿è¡Œã€‚</p>
<p>åœ¨pdscanä¸­ï¼Œéœ€è¦ä½¿ç”¨å®šæ—¶ä»»åŠ¡æ¥æ£€æŸ¥æ˜¯å¦æœ‰æ–°æ‰«æä»»åŠ¡ä¸‹è¾¾ï¼Œä¾‹å¦‚ï¼Œæ¯10ç§’æ£€æŸ¥ä¸€æ¬¡æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨waitingçš„ä»»åŠ¡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> Celery</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º Celery å®ä¾‹</span></span><br><span class="line">app = Celery(<span class="string">&#x27;tasks&#x27;</span>, broker=<span class="string">&#x27;redis://localhost:6379/0&#x27;</span>, backend=<span class="string">&#x27;redis://localhost:6379/1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_task1</span>():</span><br><span class="line">    <span class="comment"># ç”Ÿæˆä»»åŠ¡md5</span></span><br><span class="line">    task_id = md5(<span class="built_in">str</span>(time.time()).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºtask_idä¸ºåç§°çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡1:<span class="subst">&#123;task_id&#125;</span>æ‰§è¡Œäº:&#x27;</span>, datetime.now())</span><br><span class="line">    time.sleep(<span class="number">7</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡1:<span class="subst">&#123;task_id&#125;</span>ç»“æŸäº:&#x27;</span>, datetime.now())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_task2</span>():</span><br><span class="line">    <span class="comment"># ç”Ÿæˆä»»åŠ¡md5</span></span><br><span class="line">    task_id = md5(<span class="built_in">str</span>(time.time()).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœ¨æ­¤å¤„å®šä¹‰ä½ çš„ä»»åŠ¡é€»è¾‘</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡2:<span class="subst">&#123;task_id&#125;</span>æ‰§è¡Œäº:&#x27;</span>, datetime.now())</span><br><span class="line">    time.sleep(<span class="number">9</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å®šæ—¶ä»»åŠ¡2:<span class="subst">&#123;task_id&#125;</span>ç»“æŸäº:&#x27;</span>, datetime.now())</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å®šæ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@app.on_after_configure.connect</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_periodic_tasks</span>(<span class="params">sender, **kwargs</span>):</span><br><span class="line">    <span class="comment"># æ¯éš” 5 ç§’æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡</span></span><br><span class="line">    sender.add_periodic_task(<span class="number">5.0</span>, my_task1.s(), name=<span class="string">&#x27;ä»»åŠ¡1&#x27;</span>)</span><br><span class="line">    <span class="comment"># æ¯éš” 5 ç§’æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡</span></span><br><span class="line">    sender.add_periodic_task(<span class="number">5.0</span>, my_task2.s(), name=<span class="string">&#x27;ä»»åŠ¡2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ Celery å®šæ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.start()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
  </entry>
  <entry>
    <title>VMware-12ä»£CPUå¡é¡¿è§£å†³åŠæ³•</title>
    <url>/2023/05/28/VMware-12%E4%BB%A3CPU%E5%8D%A1%E9%A1%BF%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
    <content><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>è‡ªä»æ¢äº†æ–°ç”µè„‘ï¼Œè™šæ‹Ÿæœºå°±ä¸€ç›´å¡çš„ä¸è¡Œï¼Œå“ªæ€•å°±ç”¨win7å¼€ä¸ªæ–‡ä»¶ç®¡ç†å™¨ä¹Ÿèƒ½å¡ä¸ªåŠå¹´</p>
<p>æ”¹äº†ç¡¬ä»¶é…ç½®ï¼Œ8æ ¸8Gçš„win7ç…§å¡ä¸è¯¯ï¼Œä¾§é€šé“ç¼“è§£æ ¹æœ¬æ²¡å¼€</p>
<p>ä¸åªæ˜¯Windowsï¼Œkaliã€ubuntuå•¥çš„ä¹Ÿå¡ï¼Œè¿˜ä»¥ä¸ºä¹°åˆ°äº†å‡ç”µè„‘</p>
<h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>åœ¨ç™¾æ€ä¸å¾—å…¶è§£ä¹‹æ—¶ï¼Œçœ‹åˆ°äº†é›¨è‹å¤§ä½¬çš„åšå®¢ï¼š</p>
<p><a href="https://www.ddosi.org/vmware17/">VMware workstation 16 &amp; 17 12ä»£CPUå¡é¡¿è§£å†³åŠæ³• - ğŸ”°é›¨è‹â„’ğŸ”° (ddosi.org)</a></p>
<blockquote>
<p>æœ€ç»ˆçš„è§£å†³åŠæ³•å¦‚ä¸‹:</p>
<p>å…³é—­æˆ–æŒ‚èµ·æ‰€æœ‰è™šæ‹Ÿæœº,æ‰¾åˆ°VMwareå®‰è£…ç›®å½•,vmware.exeå³é”®â€“å±æ€§â€“å…¼å®¹æ€§â€“å‹¾é€‰â€ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œæ­¤ç¨‹åºâ€œ[åº”ç”¨-ç¡®å®š]</p>
<p><img src="http://pic.rayi.sdpcsec.cn/21133935.webp" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p><img src="http://pic.rayi.sdpcsec.cn/21134026.webp"></p>
<p>å†æ¬¡æ‰“å¼€è™šæ‹Ÿæœºå°±ä¸ä¼šå¡é¡¿äº†.</p>
</blockquote>
<p>è¯•äº†è¯•ï¼Œç¡®å®å¥½ä½¿ï¼Œç¬é—´ä¸æ»‘äº†ï¼Œå¤§ä½¬ç‰›é€¼</p>
]]></content>
      <categories>
        <category>æŠ˜è…¾ç¯å¢ƒ</category>
      </categories>
  </entry>
  <entry>
    <title>åˆ©ç”¨SSHéš§é“å»ºç«‹ç«¯å£è½¬å‘æˆ–Socksä»£ç†</title>
    <url>/2023/06/18/%E5%88%A9%E7%94%A8SSH%E9%9A%A7%E9%81%93%E5%BB%BA%E7%AB%8B%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E6%88%96Socks%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[<h2 id="åˆ©ç”¨SSHéš§é“å»ºç«‹ç«¯å£è½¬å‘æˆ–Socksä»£ç†"><a href="#åˆ©ç”¨SSHéš§é“å»ºç«‹ç«¯å£è½¬å‘æˆ–Socksä»£ç†" class="headerlink" title="åˆ©ç”¨SSHéš§é“å»ºç«‹ç«¯å£è½¬å‘æˆ–Socksä»£ç†"></a>åˆ©ç”¨SSHéš§é“å»ºç«‹ç«¯å£è½¬å‘æˆ–Socksä»£ç†</h2><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä¸€äº›å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬å»ºç«‹ä»£ç†éš§é“ï¼Œè¾¾åˆ°éšè—IPåœ°å€ï¼Œæˆ–è€…ç©¿é€é˜²ç«å¢™çš„æ•ˆæœã€‚å¥½ç”¨çš„å·¥å…·æœ‰å¾ˆå¤šï¼Œä½†æœ€å¸¸è§çš„åº”è¯¥è¿˜æ˜¯sshã€‚</p>
<p>sshè‡ªå¸¦ä¸‰ç§è½¬å‘åŠŸèƒ½ï¼Œåˆ†åˆ«ä¸ºåŠ¨æ€è½¬å‘ï¼ˆSocksä»£ç†ï¼‰ã€æœ¬åœ°ç«¯å£è½¬å‘ã€è¿œç¨‹ç«¯å£è½¬å‘</p>
<h3 id="ç¯å¢ƒå‡è®¾"><a href="#ç¯å¢ƒå‡è®¾" class="headerlink" title="ç¯å¢ƒå‡è®¾"></a>ç¯å¢ƒå‡è®¾</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸‰å°ä¸»æœºï¼š</p>
<ul>
<li>Client Aï¼šWindows Localhost</li>
<li>Tunnel Bï¼šLinux ssh 192.168.1.2:22</li>
<li>Tunnel Cï¼šLinux ssh 192.168.1.3:33</li>
</ul>
<p>ä»¥ä¸‹æ‰€æœ‰ç¤ºä¾‹éƒ½æŒ‰ç…§æ­¤ç¯å¢ƒè¿›è¡Œè¯´æ˜ï¼Œæˆ‘ä»¬æœ¬åœ°ç»ˆç«¯å°±æ˜¯Client A</p>
<h3 id="åŠ¨æ€è½¬å‘ï¼ˆsocksä»£ç†ï¼‰"><a href="#åŠ¨æ€è½¬å‘ï¼ˆsocksä»£ç†ï¼‰" class="headerlink" title="åŠ¨æ€è½¬å‘ï¼ˆsocksä»£ç†ï¼‰"></a>åŠ¨æ€è½¬å‘ï¼ˆsocksä»£ç†ï¼‰</h3><p>newbing:SSHçš„åŠ¨æ€ç«¯å£è½¬å‘ï¼ˆä¹Ÿç§°ä¸ºâ€œSOCKSä»£ç†â€ï¼‰å…è®¸æ‚¨é€šè¿‡SSHè¿æ¥å°†æœ¬åœ°è®¡ç®—æœºä¸Šçš„æŒ‡å®šç«¯å£é…ç½®ä¸ºSOCKSä»£ç†æœåŠ¡å™¨ã€‚å½“æ‚¨çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°è¯¥ç«¯å£æ—¶ï¼ŒSSHå®¢æˆ·ç«¯ä¼šåˆ›å»ºåˆ°è¿œç¨‹æœåŠ¡å™¨çš„åŠ å¯†éš§é“ï¼Œå¹¶ä¸”æ‰€æœ‰æµç»è¯¥éš§é“çš„æµé‡éƒ½å°†è¢«åŠ¨æ€è½¬å‘åˆ°ç›®æ ‡ä¸»æœºå’Œç«¯å£ã€‚</p>
<p>åŠ¨æ€ç«¯å£è½¬å‘çš„å‘½ä»¤æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -Nf -D [bind_address:]port user@remotehost -p 22</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>-D [bind_address:]port</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„æœ¬åœ°IPåœ°å€ï¼ˆå¯é€‰ï¼‰å’Œè¦ä¾¦å¬çš„ç«¯å£å·ã€‚</li>
<li><code>-N</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿æ¥ä¸éœ€è¦æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚ä»…ä»…åšç«¯å£è½¬å‘ã€‚</li>
<li><code>-f</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯åœ¨åå°è¿è¡Œã€‚</li>
</ul>
<p><code>bind_address</code>æ˜¯æŒ‡å®šè¦ä½¿ç”¨çš„æœ¬åœ°IPåœ°å€ã€‚å®ƒæ˜¯å¯é€‰çš„ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œé€šå¸¸é»˜è®¤ä¸º<code>localhost</code>ï¼Œä½†å®é™…é»˜è®¤åº”æ ¹æ®é…ç½®æ–‡ä»¶ä¸­GatewayPortsæ¥ã€‚è¿™æ„å‘³ç€åªæœ‰æœ¬åœ°è®¡ç®—æœºä¸Šçš„åº”ç”¨ç¨‹åºæ‰èƒ½è¿æ¥åˆ°SOCKSä»£ç†æœåŠ¡å™¨ã€‚</p>
<p>å¦‚æœæ‚¨å¸Œæœ›å…¶ä»–è®¡ç®—æœºä¹Ÿèƒ½è¿æ¥åˆ°SOCKSä»£ç†æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥å°†<code>bind_address</code>è®¾ç½®ä¸ºæ‚¨è®¡ç®—æœºçš„å…¬å…±IPåœ°å€æˆ–<code>0.0.0.0</code>ï¼ˆè¡¨ç¤ºä¾¦å¬æ‰€æœ‰ç½‘ç»œæ¥å£ï¼‰ã€‚</p>
<p>å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ç›¸å½“äºæŠŠè¿œç¨‹æœåŠ¡å™¨å½“åšsocksæœåŠ¡å™¨ï¼Œè¿›è¡Œä»£ç†ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹</p>
<p>æˆ‘ä»¬å°†Aä¸Bä¹‹é—´å»ºç«‹åŠ¨æ€è½¬å‘</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -D 1234 -N -f root@192.168.1.2 -p 22</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æŠŠæµè§ˆå™¨æŒ‚ä¸Šä»£ç†ï¼ˆsocks5:&#x2F;&#x2F;127.0.0.1:1234ï¼‰ï¼Œæœ€ç»ˆå‡ºç½‘åœ°å€ä¸º192.168.1.2</p>
<p>åœ¨æœ¬åœ°ç»ˆç«¯ä¸­è¿è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rayi @ a in ~ [10:47:35] C:255</span></span><br><span class="line">$ ssh -Nf -D localhost:1234 root@47.xxx -p 22</span><br><span class="line">The authenticity of host <span class="string">&#x27;[47.xxx]:22 ([47.xxx]:22)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:xxx.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[47.xxx]:22<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@47.xxx&#x27;</span>s password:</span><br><span class="line">Permission denied, please try again.</span><br><span class="line">root@47.xxx<span class="string">&#x27;s password:</span></span><br><span class="line"><span class="string">Permission denied, please try again.</span></span><br><span class="line"><span class="string">root@47.xxx&#x27;</span>s password:</span><br><span class="line"></span><br><span class="line"><span class="comment"># rayi @ a in ~ [10:48:14]</span></span><br><span class="line">$ curl cip.cc</span><br><span class="line">IP      : 59.xxx</span><br><span class="line"></span><br><span class="line"><span class="comment"># rayi @ a in ~ [10:48:17]</span></span><br><span class="line">$ proxychains curl cip.cc</span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|DNS-request| cip.cc</span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1234-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| cip.cc is 124.70.129.64</span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1234-&lt;&gt;&lt;&gt;-124.70.129.64:80-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">IP      : 47.xxx</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æœ¬åœ°ç«¯å£è½¬å‘"><a href="#æœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="æœ¬åœ°ç«¯å£è½¬å‘"></a>æœ¬åœ°ç«¯å£è½¬å‘</h3><p>newbing:SSHçš„æœ¬åœ°ç«¯å£è½¬å‘å…è®¸æ‚¨é€šè¿‡SSHè¿æ¥å°†æœ¬åœ°è®¡ç®—æœºä¸Šçš„æŒ‡å®šç«¯å£è½¬å‘åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æŒ‡å®šä¸»æœºå’Œç«¯å£ã€‚å½“æ‚¨çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°è¯¥ç«¯å£æ—¶ï¼ŒSSHå®¢æˆ·ç«¯ä¼šåˆ›å»ºåˆ°è¿œç¨‹æœåŠ¡å™¨çš„åŠ å¯†éš§é“ï¼Œå¹¶ä¸”æ‰€æœ‰æµç»è¯¥éš§é“çš„æµé‡éƒ½å°†è¢«è½¬å‘åˆ°ç›®æ ‡ä¸»æœºå’Œç«¯å£ã€‚</p>
<p>æœ¬åœ°ç«¯å£è½¬å‘çš„å‘½ä»¤æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -Nf -L [bind_address:]port:host:hostport user@remotehost</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>-L [bind_address:]port:host:hostport</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„æœ¬åœ°IPåœ°å€ï¼ˆå¯é€‰ï¼‰ã€è¦ä¾¦å¬çš„ç«¯å£å·ã€ç›®æ ‡ä¸»æœºå’Œç›®æ ‡ç«¯å£ã€‚</li>
<li><code>-N</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿æ¥ä¸éœ€è¦æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚ä»…ä»…åšç«¯å£è½¬å‘ã€‚</li>
<li><code>-f</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯åœ¨åå°è¿è¡Œã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼Œè‹¥æˆ‘ä»¬çš„å‘½ä»¤ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -Nf -L [bind_address:]HostAPort:HostC:HostCPort user@HostB</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œè¯¥å‘½ä»¤å°±æ˜¯å°†å¯¹[bind_address:]APortçš„è®¿é—®ï¼Œé€šè¿‡Bï¼Œè½¬å‘æˆå¯¹C:CPortçš„è®¿é—®</p>
<p>ç¤ºä¾‹ï¼Œå°†æœ¬åœ°çš„1234ç«¯å£ä¸è¿œç¨‹çš„2333ç«¯å£ç»‘å®š</p>
<p>åœ¨æœ¬åœ°ç»ˆç«¯ä¸­è¿è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rayi @ a in ~ [11:02:44] C:1</span></span><br><span class="line">$ ssh -Nf -L 1234:47.xxx:23002 root@47.xxx -p 3389</span><br><span class="line">root@47.xxx<span class="string">&#x27;s password:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># rayi @ a in ~ [11:03:28]</span></span><br><span class="line"><span class="string">$ curl 127.0.0.1:1234</span></span><br></pre></td></tr></table></figure>

<p>è¿œç¨‹æœåŠ¡å™¨ç›‘å¬ï¼Œå¯å¾—åˆ°ç»“æœ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># root @ VM-4-2-ubuntu in ~ [11:03:37]</span></span><br><span class="line">$ nc -lvp 23002</span><br><span class="line">Listening on 0.0.0.0 23002</span><br><span class="line">Connection received on 47.xxx 46662</span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:1234</span><br><span class="line">User-Agent: curl/7.68.0</span><br><span class="line">Accept: */*</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="è¿œç¨‹ç«¯å£è½¬å‘"><a href="#è¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="è¿œç¨‹ç«¯å£è½¬å‘"></a>è¿œç¨‹ç«¯å£è½¬å‘</h3><p>newbingï¼šSSHçš„è¿œç¨‹ç«¯å£è½¬å‘å…è®¸æ‚¨é€šè¿‡SSHè¿æ¥å°†è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æŒ‡å®šç«¯å£è½¬å‘åˆ°æœ¬åœ°è®¡ç®—æœºä¸Šçš„æŒ‡å®šä¸»æœºå’Œç«¯å£ã€‚å½“è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°è¯¥ç«¯å£æ—¶ï¼ŒSSHå®¢æˆ·ç«¯ä¼šåˆ›å»ºåˆ°æœ¬åœ°è®¡ç®—æœºçš„åŠ å¯†éš§é“ï¼Œå¹¶ä¸”æ‰€æœ‰æµç»è¯¥éš§é“çš„æµé‡éƒ½å°†è¢«è½¬å‘åˆ°ç›®æ ‡ä¸»æœºå’Œç«¯å£ã€‚</p>
<p>è¿œç¨‹ç«¯å£è½¬å‘çš„å‘½ä»¤æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -Nf -R [bind_address:]port:host:hostport  user@remotehost</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>-R [bind_address:]port:host:hostport</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„è¿œç¨‹IPåœ°å€ï¼ˆå¯é€‰ï¼‰ã€è¦ä¾¦å¬çš„ç«¯å£å·ã€ç›®æ ‡ä¸»æœºå’Œç›®æ ‡ç«¯å£ã€‚</li>
<li><code>-N</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿æ¥ä¸éœ€è¦æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚ä»…ä»…åšç«¯å£è½¬å‘ã€‚</li>
<li><code>-f</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯åœ¨åå°è¿è¡Œã€‚</li>
</ul>
<p>è¿™ä¸ªå°±è·Ÿä¸Šé¢çš„ç›¸åï¼Œç®€å•æ¥è¯´ï¼Œè‹¥æˆ‘ä»¬çš„å‘½ä»¤ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -Nf -R [bind_address:]HostBPort:HostC:HostCPort user@HostB</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œè¯¥å‘½ä»¤å°±æ˜¯å°†å¯¹[bind_address:]BPortçš„è®¿é—®ï¼Œé€šè¿‡Aï¼Œè½¬å‘æˆå¯¹C:CPortçš„è®¿é—®</p>
<p>ç¤ºä¾‹ï¼Œåœ¨æœ¬åœ°ç»ˆç«¯æ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rayi @ a in ~ [11:10:17]</span></span><br><span class="line">$ ssh -Nf -R 1234:127.0.0.1:2333 root@47.xxx -p 3389</span><br><span class="line">root@47.xxx<span class="string">&#x27;s password:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># rayi @ a in ~ [11:11:53]</span></span><br><span class="line"><span class="string">$ nc -lvp 2333</span></span><br><span class="line"><span class="string">Listening on 0.0.0.0 2333</span></span><br><span class="line"><span class="string">Connection received on localhost 13190</span></span><br><span class="line"><span class="string">GET / HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1:1234</span></span><br><span class="line"><span class="string">User-Agent: curl/7.81.0</span></span><br><span class="line"><span class="string">Accept: */*</span></span><br></pre></td></tr></table></figure>

<p>è¿œç¨‹æœåŠ¡å™¨æ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># root @ VM-4-2-ubuntu in ~ [11:05:28] C:130</span></span><br><span class="line">$ curl http://127.0.0.1:1234</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="åŒå±‚-x2F-å¤šå±‚ä»£ç†éš§é“"><a href="#åŒå±‚-x2F-å¤šå±‚ä»£ç†éš§é“" class="headerlink" title="åŒå±‚&#x2F;å¤šå±‚ä»£ç†éš§é“"></a>åŒå±‚&#x2F;å¤šå±‚ä»£ç†éš§é“</h3><p>åˆ©ç”¨sshç«¯å£è½¬å‘åŠŸèƒ½å»ºç«‹èµ·åŒå±‚ä»£ç†éš§é“ï¼Œå³æœ¬æœºé“¾æ¥Aï¼ŒAè½¬å‘ç»™Bï¼ŒBè®¿é—®çœŸæ­£çš„æœåŠ¡å™¨</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨SSHçš„ç«¯å£è½¬å‘åŠŸèƒ½æ¥å»ºç«‹åŒå±‚ä»£ç†éš§é“ã€‚åˆ©ç”¨sshæ„å»ºå¤šçº§è·³æ¿ï¼Œå°±æ˜¯å…ˆç”¨æœ¬åœ°è½¬å‘å°†è¿œç«¯æœºå™¨çš„sshç«¯å£ä¸æœ¬åœ°ç«¯å£åšæ˜ å°„ï¼Œç„¶åå†é€šè¿‡æœ¬åœ°ç«¯å£ç»§ç»­ä¸å…¶ä»–è¿œç«¯æœºå™¨çš„sshç«¯å£æ„å»ºæ˜ å°„ï¼Œç›´è‡³æœ€åä¸€è·³æ—¶é‡‡ç”¨ä»»æ„åŠ¨æ€ç«¯å£è½¬å‘ï¼ˆå»ºç«‹socksæœåŠ¡å™¨ï¼‰ã€‚ æœ€åæœ¬åœ°ä½¿ç”¨socksä»£ç†å·¥å…·è¿›è¡Œé…ç½®ï¼Œå°±å¯ä»¥æ ¹æ®éœ€è¦è®©åº”ç”¨æŒ‰ç…§ä¹‹å‰æ„å»ºçš„éš§é“è¿›è¡Œé€šä¿¡ã€‚Â¹</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸¤çº§è·³æ¿ï¼Œç³»ç»Ÿä¸ºlinuxï¼Œå®éªŒç¯å¢ƒä¸ºï¼š</p>
<ul>
<li>Client Aï¼šWindows Localhost</li>
<li>Tunnel Bï¼šLinux ssh 192.168.1.39:22</li>
<li>Tunnel Cï¼šLinux ssh 192.168.1.42:55</li>
</ul>
<p>é‚£ä¹ˆç¬¬ä¸€å±‚è½¬å‘ä¸ºï¼š A (localhost:12345)-&gt;B (192.168.1.39:22)-&gt;C (192.168.1.42:55)ã€‚Â¹</p>
<p>æ‚¨å¯ä»¥å‚è€ƒè¿™ä¸ªä¾‹å­æ¥è®¾ç½®æ‚¨è‡ªå·±çš„åŒå±‚ä»£ç†éš§é“ã€‚</p>
<p>æ ¹æ®æ‚¨ä¹‹å‰æåˆ°çš„ä¾‹å­ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š</p>
<ol>
<li><p>åœ¨Client Aä¸Šæ‰§è¡Œç¬¬ä¸€å±‚è½¬å‘å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -Nf -C -L 12345:192.168.1.42:55 rootB@192.168.1.39 -p 22</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥æ˜¯åšäº†æœ¬åœ°12345ç«¯å£åˆ°è¿œç¨‹Cçš„55ç«¯å£æ˜ å°„ï¼ŒAä¸Bä¹‹é—´çš„é€šä¿¡æ˜¯SSHåŠ å¯†é€šä¿¡ã€‚</p>
</li>
<li><p>åœ¨Client Aä¸Šæ‰§è¡Œç¬¬äºŒå±‚è½¬å‘å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -Nf -C -D localhost:9833 rootC@localhost -p 12345</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥åªç»‘å®šæœ¬åœ°ç«¯å£ï¼ˆ9833ï¼‰ï¼Œè™½ç„¶æ˜¯ä¸æœ¬åœ°çš„12345é€šä¿¡ï¼Œä½†å®è´¨æ˜¯é€šè¿‡tunnel1ä¸Cå»ºç«‹äº†åŠ¨æ€è½¬å‘å…³ç³»ã€‚æ­¤æ—¶Cå……å½“Socksä»£ç†æœåŠ¡å™¨çš„è§’è‰²ã€‚</p>
</li>
</ol>
<p>å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>è¿™äº›å‘½ä»¤ä¸­çš„å‚æ•°åˆ†åˆ«è¡¨ç¤ºä»¥ä¸‹å«ä¹‰ï¼š</p>
<ul>
<li><code>-N</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿æ¥ä¸éœ€è¦æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚ä»…ä»…åšç«¯å£è½¬å‘ã€‚</li>
<li><code>-f</code>ï¼šå‘Šè¯‰SSHå®¢æˆ·ç«¯åœ¨åå°è¿è¡Œã€‚</li>
<li><code>-C</code>ï¼šå¯ç”¨å‹ç¼©æ•°æ®ä¼ è¾“ã€‚</li>
<li><code>-L</code>ï¼šæŒ‡å®šæœ¬åœ°ç«¯å£è½¬å‘ã€‚æ ¼å¼ä¸º<code>[bind_address:]port:host:hostport</code>ï¼Œè¡¨ç¤ºå°†æœ¬åœ°çš„<code>port</code>ç«¯å£ä¸è¿œç¨‹çš„<code>host:hostport</code>å»ºç«‹æ˜ å°„å…³ç³»ã€‚</li>
<li><code>-D [bind_address:]port</code>ï¼šæŒ‡å®šåŠ¨æ€åº”ç”¨ç¨‹åºçº§åˆ«çš„ç«¯å£è½¬å‘ã€‚æ ¼å¼ä¸º<code>[bind_address:]port</code>ï¼Œè¡¨ç¤ºåœ¨æœ¬åœ°æœºå™¨ä¸Šåˆ†é…äº†ä¸€ä¸ªç«¯å£è¿›è¡Œä¾¦å¬ï¼Œä¸€æ—¦è¯¥ç«¯å£æœ‰äº†è¿æ¥ï¼Œè½¬å‘å‡ºå»çš„æ•°æ®ç”±å‘èµ·çš„è¯·æ±‚æ¥å†³å®šäº¤ç»™è¿œç«¯æœºå™¨çš„å“ªä¸ªç«¯å£ã€‚</li>
</ul>
<p>å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>æº: ä¸å¿…åº”çš„å¯¹è¯ï¼Œ 2023&#x2F;6&#x2F;18<br>(1) åˆ©ç”¨SSHéš§é“æ„å»ºå¤šçº§Tunnel - çŸ¥ä¹ - çŸ¥ä¹ä¸“æ . <a href="https://zhuanlan.zhihu.com/p/94624842">https://zhuanlan.zhihu.com/p/94624842</a>.<br>(2) å½»åº•ææ‡‚SSHç«¯å£è½¬å‘å‘½ä»¤ - çŸ¥ä¹ - çŸ¥ä¹ä¸“æ . <a href="https://zhuanlan.zhihu.com/p/148825449">https://zhuanlan.zhihu.com/p/148825449</a>.<br>(3) ä½¿ç”¨SSHåè®®æ­å»ºéš§é“ï¼ˆé™„æ­å»ºç¯å¢ƒè¶…è¯¦ç»†ï¼‰ - CSDNåšå®¢. <a href="https://blog.csdn.net/qq_45300786/article/details/111025981">https://blog.csdn.net/qq_45300786/article/details/111025981</a>.</p>
]]></content>
      <categories>
        <category>æ¸—é€æµ‹è¯•</category>
      </categories>
  </entry>
  <entry>
    <title>è¿œç¨‹æœåŠ¡å™¨æŠ“åŒ…æ–¹æ³•</title>
    <url>/2023/05/21/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h2 id="è¿œç¨‹æŠ“åŒ…æ–¹æ³•"><a href="#è¿œç¨‹æŠ“åŒ…æ–¹æ³•" class="headerlink" title="è¿œç¨‹æŠ“åŒ…æ–¹æ³•"></a>è¿œç¨‹æŠ“åŒ…æ–¹æ³•</h2><p>åœ¨å®é™…ç¯å¢ƒä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°éƒ¨åˆ†ç›®æ ‡æœºå™¨å­˜åœ¨æ€§èƒ½å·®ï¼Œå­˜å‚¨ç©ºé—´å°ç­‰æƒ…å†µï¼Œå¯¼è‡´æ— æ³•é•¿æ—¶é—´åœ¨ç›®æ ‡æœºæŠ“æµé‡å¹¶å­˜å‚¨æ•°æ®åŒ…</p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨ç›®æ ‡æœºå·¥å…·ï¼Œå¯¹å…¶è¿›è¡Œè¿œç¨‹æŠ“åŒ…ï¼Œä»è€Œé¿å…å°†æ•°æ®åŒ…å­˜å‚¨åœ¨ç›®æ ‡æœºä¸Š</p>
<h3 id="Tcpdump-ssh-wireshark"><a href="#Tcpdump-ssh-wireshark" class="headerlink" title="Tcpdump+ssh+wireshark"></a>Tcpdump+ssh+wireshark</h3><p><a href="https://blog.csdn.net/koalazoo/article/details/84958752">(50æ¡æ¶ˆæ¯) ç”¨wireshark+tcpdump+sshè¿œç¨‹æŠ“åŒ…å¹¶å®æ—¶æ˜¾ç¤º_tcpdump æŠ“åŒ…å®æ—¶è½¬å‘_è½¬è½¬è€³æœµçš„åšå®¢-CSDNåšå®¢</a></p>
<p>åˆ©ç”¨sshç™»å½•è¿œç¨‹ä¸»æœºï¼Œç„¶åå‘½ä»¤tcpdumpå¼€å¯æŠ“åŒ…ï¼Œå¹¶å°†tcpdumpæŠ“åˆ°çš„ç»“æœè¾“å‡ºåˆ°stdoutï¼Œå†ä¼ å›æœ¬åœ°PCæœºï¼Œè€Œæœ¬åœ°PCæœºä¸Šçš„wiresharkä»¥stdinä¸ºè¾“å…¥ï¼Œä¸¤è€…ä»¥ç®¡é“è¿æ¥ä¼ è¾“</p>
<h4 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh root@some.host <span class="string">&#x27;tcpdump -i eth0 port not 22 -s 0 -l -w -&#x27;</span> | wireshark -k -i -</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤æ‰§è¡Œåä¼šå¼¹å‡ºwiresharkç•Œé¢ï¼Œè¿™æ—¶éœ€è¦åˆ‡å›åˆšåˆšçš„å‘½ä»¤è¡Œï¼Œå› ä¸ºéœ€è¦è¾“å…¥å¯†ç ä»¥ç™»å½•è¿œç¨‹ä¸»æœºï¼ˆå·²ç»é…ç½®å…å¯†å¦è¯´ï¼‰ï¼Œè¿æ¥æˆåŠŸåå³å¼€å§‹æŠ“åŒ…ï¼Œå¹¶åœ¨æœ¬åœ°PCçš„wiresharkä¸Šå®æ—¶æ˜¾ç¤ºæŠ“åŒ…ç»“æœã€‚</p>
<blockquote>
<p>&#x3D;&#x3D;æ³¨æ„&#x3D;&#x3D;</p>
<p>ç”±äºæ˜¯é€šè¿‡sshéš§é“å’Œè¿œç¨‹ä¸»æœºè¿›è¡Œçš„é“¾æ¥ï¼Œé“¾æ¥ä¸­çš„é€šè®¯ä¹Ÿä¼šè¢«æŠ“å–ï¼Œä»è€Œå¯¼è‡´æ•°æ®åŒ…å¤§å°ä¸æ–­æˆå€å¢é•¿</p>
<p>å¯å°è¯•ä¸æŠ“sshç«¯å£çš„æ•°æ®åŒ…ï¼Œæˆ–è€…åªæŠ“å†…ç½‘é€šè®¯ç½‘å¡çš„æ•°æ®åŒ…</p>
</blockquote>
<h4 id="å‚æ•°è§£é‡Š"><a href="#å‚æ•°è§£é‡Š" class="headerlink" title="å‚æ•°è§£é‡Š"></a>å‚æ•°è§£é‡Š</h4><p>tcpdumpä¸­ <code>-l</code> ï¼ˆè¿™é‡Œæ˜¯å°å†™çš„å­—æ¯Lï¼‰æ˜¯æŒ‡line-bufferï¼Œå³ä¸ä½¿ç”¨ç¼“å­˜ï¼Œç›´æ¥è¾“å‡ºï¼Œå¦åˆ™å°±ä¼šä¸€æ®µæ®µçš„è¾“å‡º</p>
<p><code>-w -</code>æ˜¯æŒ‡å†™æ–‡ä»¶ï¼Œç›®æ ‡æ–‡ä»¶ä¸ºæ ‡å‡†è¾“å‡ºã€‚</p>
<p>wiresharkä¸­ <code>-k</code> æ˜¯æŒ‡é©¬ä¸Šå¼€å§‹æ•è·æ•°æ®ï¼Œ<code>-i -</code> æ˜¯æŒ‡ä»æŒ‡å®šæ¥å£è·å–ï¼Œæºä¸ºæ ‡å‡†è¾“å…¥ã€‚</p>
<h4 id="æˆªå›¾"><a href="#æˆªå›¾" class="headerlink" title="æˆªå›¾"></a>æˆªå›¾</h4><p><img src="http://pic.rayi.sdpcsec.cn/image-20230520191907142.png" alt="image-20230520191907142"></p>
<h3 id="Tcpdump-nc-wireshark"><a href="#Tcpdump-nc-wireshark" class="headerlink" title="Tcpdump+nc+wireshark"></a>Tcpdump+nc+wireshark</h3><p>å¦‚æœæŸäº›æœºå™¨ä¸Šæ²¡æœ‰sshï¼ˆä¾‹å¦‚æŸäº›è·¯ç”±å™¨åªæœ‰Telnetï¼Œæˆ–è€…åªæœ‰webshellï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ncè¿›è¡Œæ•°æ®ä¼ è¾“</p>
<blockquote>
<p>&#x3D;&#x3D;æ³¨æ„&#x3D;&#x3D;</p>
<p>åŒæ ·ï¼Œè¦é¿å…æŠ“å–é€šè®¯ç«¯å£çš„æ•°æ®åŒ…</p>
</blockquote>
<p><img src="http://pic.rayi.sdpcsec.cn/image-20230520193304708.png" alt="image-20230520193304708"></p>
<h4 id="å‘½ä»¤-1"><a href="#å‘½ä»¤-1" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h4><p>ç›®æ ‡æœº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 port not 2333 -s 0 -l -w - | nc 192.168.2.111 2333</span><br></pre></td></tr></table></figure>

<p>æ“ä½œæœº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvp 2333 | wireshark -k -i -</span><br></pre></td></tr></table></figure>

<p><img src="http://pic.rayi.sdpcsec.cn/image-20230520193735800.png" alt="image-20230520193735800"></p>
<h3 id="Tcpdump-nc-nohup-wireshark"><a href="#Tcpdump-nc-nohup-wireshark" class="headerlink" title="Tcpdump+nc+nohup+wireshark"></a>Tcpdump+nc+nohup+wireshark</h3><p>ç›´æ¥æŒ‚åœ¨åå°è¿›è¡ŒæŠ“åŒ…ï¼Œæ³¨æ„nohupä¼šåœ¨ç®¡é“ç¬¦ä¹‹å‰æˆªæ–­ï¼Œéœ€è¦ç”¨<code>sh -c</code> å°†ç®¡é“ç¬¦åŒ…å«èµ·æ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">nohup</span> sh -c <span class="string">&#x27;tcpdump -i eth0 port not 2333 -s 0 -l -w - | nc 192.168.2.111 2333&#x27;</span> &amp;</span><br></pre></td></tr></table></figure>

<p><img src="http://pic.rayi.sdpcsec.cn/image-20230520194915007.png" alt="image-20230520194915007"></p>
]]></content>
      <categories>
        <category>åº”æ€¥å“åº”</category>
      </categories>
  </entry>
  <entry>
    <title>å…³äº</title>
    <url>/about/index.html</url>
    <content><![CDATA[<h3 id="è¿™ä¸ªç«™ç‚¹"><a href="#è¿™ä¸ªç«™ç‚¹" class="headerlink" title="è¿™ä¸ªç«™ç‚¹"></a>è¿™ä¸ªç«™ç‚¹</h3><p>ç™½å«–æ€ªä¸“å±ï¼ŒGithub+åŠ é€Ÿä¹</p>
<h3 id="æˆ‘"><a href="#æˆ‘" class="headerlink" title="æˆ‘"></a>æˆ‘</h3><ul>
<li>CTFer</li>
<li>webèœç‹—</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>categories</title>
    <url>/categories/index-1.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>friends</title>
    <url>/friends/index.html</url>
    <content><![CDATA[<div class="flink"><div class="flink-name">å‹æƒ…é“¾æ¥</div><div class="flink-desc">è¿™äº›å¤§ä½¬è¯·å¸¦å¸¦æˆ‘</div> <div class="flink-list">
          <div class="flink-list-item">
            <a href="https://www.tianchenyi.com/" title="å°ç²çš„å¤©å°˜ç¿¼" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://www.tianchenyi.com/picture/favicon.ico" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="å°ç²çš„å¤©å°˜ç¿¼" />
              </div>
              <div class="flink-item-name">å°ç²çš„å¤©å°˜ç¿¼</div> 
              <div class="flink-item-desc" title="ä»Šæ—¥äº‹,ä»Šæ—¥æ¯•">ä»Šæ—¥äº‹,ä»Šæ—¥æ¯•</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="https://www.cnblogs.com/pumpkin9/" title="pumpkin9" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="pumpkin9" />
              </div>
              <div class="flink-item-name">pumpkin9</div> 
              <div class="flink-item-desc" title="pwnå¸ˆå‚…tql">pwnå¸ˆå‚…tql</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="http://www.yukinoo.site" title="yukinoo" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="http://www.yukinoo.site/upload/2021/10/preview-2155a3b187874466a47de4fc088414c4.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="yukinoo" />
              </div>
              <div class="flink-item-name">yukinoo</div> 
              <div class="flink-item-desc" title="æ‘¸é±¼ä¹‹ç‹">æ‘¸é±¼ä¹‹ç‹</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="https://whoamianony.top/" title="WHOAMI" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://whoamianony.top/favicon.ico" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="WHOAMI" />
              </div>
              <div class="flink-item-name">WHOAMI</div> 
              <div class="flink-item-desc" title="WHOAMIå¸ˆå‚…yyds">WHOAMIå¸ˆå‚…yyds</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="http://w4nder.top/" title="w4nder" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://gitee.com/w4nder/imgs/raw/master/1571753777463409.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="w4nder" />
              </div>
              <div class="flink-item-name">w4nder</div> 
              <div class="flink-item-desc" title="w4å¸ˆå‚…ddw">w4å¸ˆå‚…ddw</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="https://www.yuque.com/th31nk/" title="th31nk" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://cdn.nlark.com/yuque/0/2021/jpeg/anonymous/1611985574086-a7aee59f-1269-451e-8177-5877ef130116.jpeg?x-oss-process=image%2Fresize%2Cm_fill%2Cw_320%2Ch_320%2Fformat%2Cpng" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="th31nk" />
              </div>
              <div class="flink-item-name">th31nk</div> 
              <div class="flink-item-desc" title="å…¨æ ˆçš„ç¥">å…¨æ ˆçš„ç¥</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="https://www.cnblogs.com/MisakaYuii-Z/" title="MisakaYu11" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="MisakaYu11" />
              </div>
              <div class="flink-item-name">MisakaYu11</div> 
              <div class="flink-item-desc" title="MisakaYu11">MisakaYu11</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="http://oriole.fun/" title="oriole" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="oriole" />
              </div>
              <div class="flink-item-name">oriole</div> 
              <div class="flink-item-desc" title="ä¸¤åªé»„é¹‚é¸£ç¿ æŸ³">ä¸¤åªé»„é¹‚é¸£ç¿ æŸ³</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="http://www.whrizyl819.xyz/" title="sp4c1ous" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://b3logfile.com/siyuan/1621238442570/assets/1024px-Vincent_van_Gogh_-_Almond_blossom_-_Google_Art_Project-20220305222307-ex7eayk.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="sp4c1ous" />
              </div>
              <div class="flink-item-name">sp4c1ous</div> 
              <div class="flink-item-desc" title="sp4c1ous">sp4c1ous</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="http://www.andynoel.xyz" title="andynoel" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="http://www.andynoel.xyz/wp-content/uploads/2022/02/IMG_648220220206-180239.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="andynoel" />
              </div>
              <div class="flink-item-name">andynoel</div> 
              <div class="flink-item-desc" title="andynoel">andynoel</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="http://mon0dy.top/" title="mon0dy" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="http://mon0dy.top/img/head.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="mon0dy" />
              </div>
              <div class="flink-item-name">mon0dy</div> 
              <div class="flink-item-desc" title="mon0dy">mon0dy</div>
            </a>
          </div>
          <div class="flink-list-item">
            <a href="https://bigpowercat.github.io/" title="å¤§èƒ½çŒ«" target="_blank">
              <div class="flink-item-icon">
                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="å¤§èƒ½çŒ«" />
              </div>
              <div class="flink-item-name">å¤§èƒ½çŒ«</div> 
              <div class="flink-item-desc" title="å¤§èƒ½çŒ«_å¤šèƒ½">å¤§èƒ½çŒ«_å¤šèƒ½</div>
            </a>
          </div></div></div>
]]></content>
  </entry>
  <entry>
    <title>categories</title>
    <url>/categories/index.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>tags</title>
    <url>/tags/index.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/lib/source/lib/canvas-nest/README.html</url>
    <content><![CDATA[<h1 align="center"><a href="https://github.com/hustcc/canvas-nest.js">canvas-nest.js</a> for <a href="https://github.com/theme-next">NexT</a></h1>

<h1 align="center">Installation</h1>

<h2 align="center">Step 1 &rarr; Go to NexT dir</h2>

<p>Change dir to <strong>NexT</strong> directory. There must be <code>layout</code>, <code>source</code>, <code>languages</code> and other directories:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> themes/next</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">bower.json  _config.yml  docs  gulpfile.coffee  languages  layout  LICENSE.md  package.json  README.md  scripts  <span class="built_in">source</span>  <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<h2 align="center">Step 2 &rarr; Get module</h2>

<p>Install module to <code>source/lib</code> directory:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/theme-next/theme-next-canvas-nest <span class="built_in">source</span>/lib/canvas-nest</span><br></pre></td></tr></table></figure>

<h2 align="center">Step 3 &rarr; Set it up</h2>

<p>Enable module in <strong>NexT</strong> <code>_config.yml</code> file:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">true</span> <span class="comment"># display on mobile or not</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&#x27;0,0,255&#x27;</span> <span class="comment"># RGB values, use &#x27;,&#x27; to separate</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span> <span class="comment"># the opacity of line: 0~1</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># z-index property of the background</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">99</span> <span class="comment"># the number of lines</span></span><br></pre></td></tr></table></figure>

<p><strong>And, if you wants to use the CDN, then need to set:</strong></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">vendors:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line">  <span class="attr">canvas_nest:</span> <span class="string">//fastly.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1.0.0/canvas-nest.min.js</span></span><br><span class="line">  <span class="attr">canvas_nest_nomobile:</span> <span class="string">//fastly.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1.0.0/canvas-nest-nomobile.min.js</span></span><br></pre></td></tr></table></figure>

<h1 align="center">Update</h1>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> themes/next/source/lib/canvas-nest</span><br><span class="line">$ git pull</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/lib/source/lib/canvas-nest/canvas-nest-nomobile.min.js</url>
    <content><![CDATA[!function(){
	var userAgentInfo = navigator.userAgent;
    var Agents = ["iPad", "iPhone", "Android", 
          "SymbianOS", "Windows Phone",
           "iPod", "webOS", "BlackBerry", "IEMobile"];
    for (var v = 0; v < Agents.length; v++) {
      if (userAgentInfo.indexOf(Agents[v]) > 0) {
        return;
      }
    }
	function o(w,v,i){return w.getAttribute(v)||i}function j(i){return document.getElementsByTagName(i)}function l(){var i=j("script"),w=i.length,v=i[w-1];return{l:w,z:o(v,"zIndex",-1),o:o(v,"opacity",0.5),c:o(v,"color","0,0,0"),n:o(v,"count",99)}}function k(){r=u.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=u.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function b(){e.clearRect(0,0,r,n);var w=[f].concat(t);var x,v,A,B,z,y;t.forEach(function(i){i.x+=i.xa,i.y+=i.ya,i.xa*=i.x>r||i.x<0?-1:1,i.ya*=i.y>n||i.y<0?-1:1,e.fillRect(i.x-0.5,i.y-0.5,1,1);for(v=0;v<w.length;v++){x=w[v];if(i!==x&&null!==x.x&&null!==x.y){B=i.x-x.x,z=i.y-x.y,y=B*B+z*z;y<x.max&&(x===f&&y>=x.max/2&&(i.x-=0.03*B,i.y-=0.03*z),A=(x.max-y)/x.max,e.beginPath(),e.lineWidth=A/2,e.strokeStyle="rgba("+s.c+","+(A+0.2)+")",e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.stroke())}}w.splice(w.indexOf(i),1)}),m(b)}var u=document.createElement("canvas"),s=l(),c="c_n"+s.l,e=u.getContext("2d"),r,n,m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){window.setTimeout(i,1000/45)},a=Math.random,f={x:null,y:null,max:20000};u.id=c;u.style.cssText="position:fixed;top:0;left:0;z-index:"+s.z+";opacity:"+s.o;j("body")[0].appendChild(u);k(),window.onresize=k;window.onmousemove=function(i){i=i||window.event,f.x=i.clientX,f.y=i.clientY},window.onmouseout=function(){f.x=null,f.y=null};for(var t=[],p=0;s.n>p;p++){var h=a()*r,g=a()*n,q=2*a()-1,d=2*a()-1;t.push({x:h,y:g,xa:q,ya:d,max:6000})}setTimeout(function(){b()},100)}();]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/lib/source/lib/canvas-nest/canvas-nest.min.js</url>
    <content><![CDATA[!function(){function o(w,v,i){return w.getAttribute(v)||i}function j(i){return document.getElementsByTagName(i)}function l(){var i=j("script"),w=i.length,v=i[w-1];return{l:w,z:o(v,"zIndex",-1),o:o(v,"opacity",0.5),c:o(v,"color","0,0,0"),n:o(v,"count",99)}}function k(){r=u.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=u.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function b(){e.clearRect(0,0,r,n);var w=[f].concat(t);var x,v,A,B,z,y;t.forEach(function(i){i.x+=i.xa,i.y+=i.ya,i.xa*=i.x>r||i.x<0?-1:1,i.ya*=i.y>n||i.y<0?-1:1,e.fillRect(i.x-0.5,i.y-0.5,1,1);for(v=0;v<w.length;v++){x=w[v];if(i!==x&&null!==x.x&&null!==x.y){B=i.x-x.x,z=i.y-x.y,y=B*B+z*z;y<x.max&&(x===f&&y>=x.max/2&&(i.x-=0.03*B,i.y-=0.03*z),A=(x.max-y)/x.max,e.beginPath(),e.lineWidth=A/2,e.strokeStyle="rgba("+s.c+","+(A+0.2)+")",e.moveTo(i.x,i.y),e.lineTo(x.x,x.y),e.stroke())}}w.splice(w.indexOf(i),1)}),m(b)}var u=document.createElement("canvas"),s=l(),c="c_n"+s.l,e=u.getContext("2d"),r,n,m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){window.setTimeout(i,1000/45)},a=Math.random,f={x:null,y:null,max:20000};u.id=c;u.style.cssText="position:fixed;top:0;left:0;z-index:"+s.z+";opacity:"+s.o;j("body")[0].appendChild(u);k(),window.onresize=k;window.onmousemove=function(i){i=i||window.event,f.x=i.clientX,f.y=i.clientY},window.onmouseout=function(){f.x=null,f.y=null};for(var t=[],p=0;s.n>p;p++){var h=a()*r,g=a()*n,q=2*a()-1,d=2*a()-1;t.push({x:h,y:g,xa:q,ya:d,max:6000})}setTimeout(function(){b()},100)}();]]></content>
  </entry>
</search>
